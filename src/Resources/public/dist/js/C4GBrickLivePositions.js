function livePositions(f,g,e,t){var y,n=(g=g).key;f.events.register("changelayer",null,function(e){"visibility"===e.property&&e.layer.key==n&&(e.layer.visibility?h():window.clearTimeout(y))});function r(e){var t,n,r,o,i,s,a,u,c,l,p=JSON.parse(e.responseText);if(!p.error)for(e={internalProjection:f.getProjectionObject(),externalProjection:new OpenLayers.Projection("EPSG:4326")},s=new OpenLayers.Format.GeoJSON(e).read(p),t=0;t<s.length;t+=1)if(o=s[t])for(l=!1,n=0;n<g.children.length;n+=1){for(r=0;r<g.children[n].features.length;r+=1)if(g.children[n].features[r]&&(i=g.children[n].features[r].data.popupInfo)&&(a=i.search('id="c4g_brick_popup_id"'))&&0<a&&(u=i.substr(a,50))&&(a=u.search('value="'))&&0<a&&(u=u.substr(a))&&(d=u.indexOf('="')+2,d=(c=u.substring(d)).indexOf('">'),(d=c.substring(0,d))&&d==o.data.id)){var d=g.children[n].features[r];d.lonlat.lon=o.geometry.x,d.lonlat.lat=o.geometry.y,o.data.popupInfo&&(d.attributes.popupInfo=d.data.popupInfo+o.data.popupInfo),d.geometry.move(o.geometry.x-d.geometry.x,o.geometry.y-d.geometry.y),g.children[n].redraw(),l=!0;break}if(l)break}y=window.setTimeout(function(){h()},1e4)}var o="src/con4gis/CoreBundle/src/Resources/api/index.php/"+e.type+"Service?method=getPositions",h=function(){OpenLayers.Request.GET({url:o,callback:r})};g.visibility&&h()}var fnPushCallback=function(e){document.getElementById("c4g_push_message").value=""};function onPushMessage(e,t,n,r){var o,i=document.getElementById("c4g_push_message").value,s="/con4gis/"+e+"Service/push?method=pushMessage&conf="+r+"&device="+n+"&token="+t+"&content="+i;(o=new XMLHttpRequest).open("GET",s),o.setRequestHeader("push",i),o.send()}